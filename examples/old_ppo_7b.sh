python3 -m EasyLM.models.llama.llama_train_ppo \
    --mesh_dim='1,1,1' \
    --load_llama_config_policy='7b' \
    --load_llama_config_reward='13b' \
    --load_checkpoint_policy='params::gs://hamishi-east1/easylm/llama2/tulu2_7b_fixed/263f4f758b194729b206d5adad2b50d7/streaming_params' \
    --load_checkpoint_reward='params::gs://hamishi-east1/tulu2_13b_ultrafeedback_rm_3ep/a6ed8c494f184548900e3b77bdf7867b/streaming_params' \
    --tokenizer.vocab_file='gs://jiachengl-east1/tokenizer.model' \
    --tokenizer.add_bos_token=True \
    --train_dataset.type='hf_prompt' \
    --train_dataset.text_processor.fields='[instruction]' \
    --train_dataset.hf_prompt_dataset.path='argilla/ultrafeedback-binarized-preferences' \
    --train_dataset.hf_prompt_dataset.seq_length=64 \
    --max_continuation_len=8 \
    --train_dataset.hf_prompt_dataset.batch_size=1 \
    --mini_batch_size=1 \
    --train_dataset.hf_prompt_dataset.num_workers=16 \
    --optimizer.type='adamw' \
    --optimizer.adamw_optimizer.weight_decay=0.0 \
    --optimizer.adamw_optimizer.warmup_ratio=0.1 \
    --checkpointer.save_optimizer_state=False \
    --logger.online=False \
    --logger.entity='liujch1998' \
    --logger.project='n-Tulu-PPO-Jax' \
    --logger.prefix='7b' \
    --logger.prefix_to_id=True \
    --logger.wandb_dir='/net/nfs.cirrascale/allennlp/jiachengl/n-tulu-ppo-jax-local/wandb' \
    --logger.output_dir='/net/nfs.cirrascale/allennlp/jiachengl/n-tulu-ppo-jax-local/runs/' \
    --use_tpu=False \
    --ppo_epochs=1 \
    --lr=1e-6 \
    --kl_coef=0.05 \
    --reward_gain=1.0 --reward_bias=0.0 \
    --save_milestone_freq=1 \
    --num_epochs=1 \
    --max_steps_per_epoch=1 \
    --generate_only=False
